# Запуск приложения и примеры использования

Краткие инструкции по запуску кода из папки d:\Прога\AI\task_2 и примеры взаимодействия с интерфейсом.

## Требования
- Python 3.8+
- Рекомендуется создать виртуальное окружение (venv)
- Необходимые пакеты:
  - gradio
  - numpy
  - pandas
  - seaborn
  - matplotlib
  - scikit-learn
  - joblib

Установка зависимостей (Windows, PowerShell / CMD):
```powershell
# из корня папки проекта
cd "d:\Прога\AI\task_2"

# создать venv (если нужно)
uv venv 
# активировать venv (PowerShell)
.venv\Scripts\activate

# установить зависимости
uv pip install gradio numpy pandas seaborn matplotlib scikit-learn joblib

uv pip install -r requirements.txt
```

## Файлы и ожидаемая структура
- main.py — основной скрипт с Gradio-интерфейсом (запускает приложение)
- model.joblib или model.pkl — заранее обученная и сохранённая модель регрессии
- (опционально) любые скрипты для обучения модели

Пример структуры:
```
d:\Прога\AI\task_2
├── app
└── main.py
├── models
└── models.joblib
├── requirements.txt
└── README
```

## Как запустить
1. Убедитесь, что model.joblib (или model.pkl) находится в той же папке, что и main.py.
2. Запустите приложение:
```powershell
cd "d:\Прога\AI\task_2"
python main.py
```
3. В консоли Gradio выдаст локальный URL (например http://127.0.0.1:7860). Откройте его в браузере.

## Как подготовить/сохранить модель (если у вас её нет)
Если модель отсутствует, можно быстро обучить простую линейную регрессию и сохранить её в формате joblib:

```python
# пример сохранения модели — запустить один раз в отдельном скрипте
from sklearn.linear_model import LinearRegression
from sklearn.datasets import make_regression
import joblib

X, y = make_regression(n_samples=200, n_features=5, noise=0.5, random_state=42)
model = LinearRegression().fit(X, y)
joblib.dump(model, "model.joblib")
```

Поместите созданный model.joblib в папку d:\Прога\AI\task_2.

Если код ожидает model.pkl, можно сохранить в .pkl:
```python
import joblib
joblib.dump(model, "model.pkl")
```

## Примеры использования интерфейса
- Откройте веб-страницу Gradio, вы увидите форму с полями для каждого признака (обязательные подписи).
- Введите числовые значения для всех признаков и нажмите кнопку "Submit"/"Predict".
- На странице появится:
  - Предсказанное значение целевой переменной.
  - R² модели (на тестовой выборке / CV) — видно в описании/статье интерфейса.
  - Уравнение регрессии в LaTeX (коэффициенты округлены до 2 знаков).
  - Визуализация: несколько scatter-графиков (топ‑3 важных признака vs целевая) с линиями регрессии. Точка, введённая пользователем, выделена красным.

Пример ввода (если модель обучена на 5 признаках):
- feature_1: 0.5
- feature_2: -1.2
- feature_3: 0.3
- feature_4: 2.0
- feature_5: -0.8

После отправки вы получите численный прогноз и графики — на одном из графиков (вдоль самого важного признака) будет отображён пользовательский пункт и линия регрессии.

## Изменение пути к модели
Если модель хранится в другом месте, откройте main.py и измените путь при загрузке:
```python
# пример в main.py
model = joblib.load(r"d:\Прога\AI\models\my_model.joblib")
```

## Советы и отладка
- Если при запуске возникает ошибка загрузки модели, проверьте имя файла и формат (.joblib/.pkl).
- Если графики не отображаются корректно, убедитесь, что seaborn и matplotlib установлены и что Gradio поддерживает вывод plt (используется gr.Plot).
- Для воспроизведения поведения с теми же данными используйте random_state в функциях генерации/разбиения данных.
